<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>ProMan — Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* CSS Variables for Light/Dark Themes - YOUR ORIGINAL GOLD COLORS */
        :root {
            /* Light Theme (Default) - YOUR ORIGINAL GOLD COLORS */
            --bg: #f5f6f7;
            --surface: #ffffff;
            --muted: #eef0f2;
            --text: #2f3337;
            --muted-text: #6b7378;
            --accent: #D4AF37;           /* GOLD ACCENT */
            --accent-dark: #b8892a;      /* DARKER GOLD */
            --sidebar-bg: #f1f3f4;
            --card-bg: #ffffff;
            --table-header-bg: rgba(212,175,55,0.1);
            --table-row-even: rgba(212,175,55,0.02);
            --table-row-hover: rgba(212,175,55,0.05);
            --table-border: rgba(212,175,55,0.3);
            --modal-bg: #ffffff;
            --modal-text: #2f3337;
            --error-bg: #fef2f2;
            --error-text: #991b1b;
            --success-bg: #f0fdf4;
            --success-text: #166534;
        }

        body.dark {
            /* Dark Theme - YOUR ORIGINAL GOLD COLORS */
            --bg: #0f172a;
            --surface: #1e293b;
            --muted: #334155;
            --text: #f1f5f9;
            --muted-text: #94a3b8;
            --accent: #F4B342;           /* BRIGHTER GOLD FOR DARK */
            --accent-dark: #E0A028;      /* DARKER GOLD FOR HOVER */
            --sidebar-bg: #1e293b;
            --card-bg: #1e293b;
            --table-header-bg: rgba(244, 179, 66, 0.15);
            --table-row-even: rgba(244, 179, 66, 0.05);
            --table-row-hover: rgba(244, 179, 66, 0.1);
            --table-border: rgba(244, 179, 66, 0.3);
            --modal-bg: #1e293b;
            --modal-text: #f1f5f9;
            --error-bg: #450a0a;
            --error-text: #fca5a5;
            --success-bg: #052e16;
            --success-text: #86efac;
        }

        /* Base Styles */
        html,body {
            height:100%;
            margin:0;
            padding:0;
        }

        body {
            min-height:100%;
            background:var(--bg);
            color:var(--text);
            font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
            -webkit-font-smoothing:antialiased;
            -moz-osx-font-smoothing:grayscale;
            display:flex;
            flex-direction:column;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* ========== HEADER FROM YOUR ADD UNIT PAGE ========== */
        header {
            background: var(--surface);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            position: sticky;
            top: 0;
            z-index: 100; /* HIGHER Z-INDEX THAN SIDEBAR */
            transition: background-color 0.3s ease;
            width: 100%;
            flex-shrink: 0; /* Prevent header from shrinking */
        }

        .text-accent { color: var(--accent) !important; }
        .bg-accent { background-color: var(--accent) !important; }
        .bg-accent-dark { background-color: var(--accent-dark) !important; }
        .bg-surface { background-color: var(--surface) !important; }
        .bg-muted { background-color: var(--muted) !important; }
        .text-muted { color: var(--muted-text) !important; }

        /* Header button styles */
        .login-btn {
            color: var(--text);
            border-color: var(--muted);
            background: var(--surface);
            border-width: 2px;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
        }

        .login-btn:hover {
            background: var(--muted);
        }

        .signup-btn {
            background: var(--accent);
            color: #2b1f00; /* readable on gold */
            padding: 0.5rem 1.25rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
        }

        body.dark .signup-btn {
            color: #1a1400;
        }

        .signup-btn:hover {
            background: var(--accent-dark);
            color: white;
        }

        /* Mobile Menu Button Styles */
        #mobile-menu-button {
            display: none;
            align-items: center;
            justify-content: center;
            width: 48px;
            height: 48px;
            border-radius: 8px;
            background: var(--surface);
            border: 1px solid var(--muted);
            color: var(--text);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        #mobile-menu-button:hover {
            background: var(--muted);
        }

        .mobile-menu-icon {
            display: flex;
            flex-direction: column;
            gap: 4px;
            width: 20px;
        }

        .mobile-menu-icon span {
            display: block;
            height: 2px;
            width: 100%;
            background: var(--text);
            transition: all 0.3s ease;
            border-radius: 2px;
        }

        #mobile-menu-button[aria-expanded="true"] .mobile-menu-icon span:nth-child(1) {
            transform: rotate(45deg) translate(4px, 4px);
        }

        #mobile-menu-button[aria-expanded="true"] .mobile-menu-icon span:nth-child(2) {
            opacity: 0;
        }

        #mobile-menu-button[aria-expanded="true"] .mobile-menu-icon span:nth-child(3) {
            transform: rotate(-45deg) translate(4px, -4px);
        }

        /* Mobile menu styling */
        #mobile-menu {
            background: var(--surface);
            border-top: 1px solid var(--muted);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            z-index: 99; /* Below header */
        }

        body.dark #mobile-menu {
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        /* Show mobile menu button on mobile/tablet, hide desktop nav */
        @media (max-width: 1024px) {
            #mobile-menu-button {
                display: flex;
            }
            #nav-links {
                display: none;
            }
        }

        @media (min-width: 1025px) {
            #mobile-menu-button {
                display: none;
            }
        }
        /* ========== END HEADER ========== */

        /* Main Layout */
        .main-wrap {
            display: flex;
            flex: 1;
            min-height: 0; /* Important for flex children */
            position: relative;
        }

        /* ========== FIXED SIDEBAR - BELOW HEADER ========== */
        .sidebar {
            width: 16rem;
            background: var(--sidebar-bg);
            border-right: 1px solid var(--muted);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            position: fixed;
            left: 0;
            top: 0; /* Start at top */
            bottom: 0; /* Extend to bottom */
            z-index: 90; /* LOWER THAN HEADER (100) */
            transition: transform .28s ease, box-shadow .28s ease, background-color 0.3s ease;
            overflow-y: auto;
            height: 100vh; /* Full viewport height */
            transform: translateX(0);
            /* Push down below header */
            margin-top: 72px; /* Header height */
            height: calc(100vh - 72px); /* Subtract header height */
        }

        /* Hide sidebar scrollbar */
        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }

        .sidebar-content::-webkit-scrollbar {
            display: none; /* Chrome, Safari and Opera */
        }

        /* Desktop layout */
        @media (min-width: 1025px) {
            .content {
                margin-left: 16rem;
                padding: 1.5rem;
                padding-top: 2rem;
                width: calc(100% - 16rem);
            }
            #sidebar-backdrop { display: none; }
        }

        /* Mobile overlay behavior */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
                position: fixed;
                left: 0;
                top: 0;
                bottom: 0;
                height: 100vh;
                margin-top: 72px;
                height: calc(100vh - 72px);
                box-shadow: 0 18px 40px rgba(16,24,40,0.12);
                z-index: 95; /* Higher on mobile to overlay content */
            }

            body.dark .sidebar {
                box-shadow: 0 18px 40px rgba(0,0,0,0.4);
            }

            .sidebar.overlay-visible {
                transform: translateX(0);
                background: var(--sidebar-bg);
            }

            .content {
                margin-left: 0;
                padding: 1rem;
                padding-top: 1.5rem;
                width: 100%;
            }

            #sidebar-backdrop {
                display: block;
                position: fixed;
                inset: 0;
                background: rgba(0,0,0,0.45);
                z-index: 85; /* Below sidebar but above content */
                opacity: 0;
                pointer-events: none;
                transition: opacity .18s ease;
                margin-top: 72px; /* Start below header */
                height: calc(100vh - 72px); /* Subtract header height */
            }

            #sidebar-backdrop.visible {
                opacity: 1;
                pointer-events: auto;
            }
        }

        /* ========== CONTENT AREA ========== */
        .content {
            flex: 1;
            overflow-y: auto;
            min-height: 0; /* Important for flex children */
        }

        /* RED VERSION: DASHBOARD CONTAINER */
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        /* RED VERSION: DASHBOARD HEADER */
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--surface);
            border-radius: .75rem;
            border: 1px solid var(--muted);
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        body.dark .dashboard-header {
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .dashboard-header h1 {
            font-size: 1.875rem;
            font-weight: 800;
            color: var(--accent);
            margin-bottom: 0.5rem;
        }

        .dashboard-header p {
            font-size: 0.875rem;
            color: var(--muted-text);
        }

        /* RED VERSION: QUICK STATS BAR */
        .quick-stats-bar {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        @media (min-width: 640px) {
            .quick-stats-bar {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .quick-stats-bar {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .quick-stat {
            background: var(--surface);
            border-radius: .75rem;
            padding: 1.25rem;
            border: 1px solid var(--muted);
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .quick-stat:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.08);
            border-color: var(--accent);
        }

        body.dark .quick-stat:hover {
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
        }

        .quick-stat-icon {
            width: 48px;
            height: 48px;
            border-radius: .75rem;
            background: rgba(212,175,55,0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent);
        }

        body.dark .quick-stat-icon {
            background: rgba(244, 179, 66, 0.08);
        }

        .quick-stat-content {
            flex: 1;
        }

        .quick-stat-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text);
            line-height: 1;
            margin-bottom: 0.25rem;
        }

        .quick-stat-label {
            font-size: 0.875rem;
            color: var(--muted-text);
            font-weight: 500;
        }

        /* RED VERSION: MAIN CONTENT GRID */
        .main-content-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        @media (min-width: 1024px) {
            .main-content-grid {
                grid-template-columns: 1fr 2fr;
            }
        }

        /* RED VERSION: DATE DISPLAY */
        .date-display {
            background: var(--surface);
            border-radius: .5rem;
            padding: 0.75rem 1.5rem;
            border-left: 4px solid var(--accent);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            text-align: center;
        }

        @media (min-width: 640px) {
            .date-display {
                text-align: left;
                border-left: none;
                border-right: 4px solid var(--accent);
            }
        }

        body.dark .date-display {
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        /* Sidebar Cards (Gold Styled) */
        .sidebar .card {
            background: linear-gradient(180deg, var(--surface), var(--surface));
            border: 1px solid var(--muted);
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            border-left: 3px solid rgba(212,175,55,0.18);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            border-radius: 0.5rem;
            padding: 0.75rem;
            margin-bottom: 0.75rem;
        }

        body.dark .sidebar .card {
            border-left: 3px solid rgba(244, 179, 66, 0.18);
        }

        /* WIGGLE EFFECT */
        .sidebar-stats .card:hover {
            animation: wiggle 0.5s ease-in-out;
            transform-origin: center center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        body.dark .sidebar-stats .card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        @keyframes wiggle {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-1.5deg); }
            50% { transform: rotate(1.5deg); }
            75% { transform: rotate(-1deg); }
        }

        /* Feature Icons */
        .feature-icon {
            width: 44px;
            height: 44px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            background: rgba(212,175,55,0.08);
            color: var(--accent);
            transition: transform 0.3s ease;
        }

        .sidebar-stats .card:hover .feature-icon {
            transform: scale(1.1) rotate(5deg);
        }

        body.dark .feature-icon {
            background: rgba(244, 179, 66, 0.08);
        }

        /* Nav Items */
        .nav-item {
            display: flex;
            align-items: center;
            gap: .75rem;
            padding: .75rem;
            border-radius: .5rem;
            color: var(--text);
            text-decoration: none;
            transition: all 0.2s ease;
            background: rgba(255,255,255,0.05);
            margin-bottom: 0.5rem;
        }

        body.dark .nav-item {
            background: rgba(255,255,255,0.05);
        }

        .nav-item:hover {
            background: rgba(255,255,255,0.1);
            color: var(--text);
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            transform: none !important;
            animation: none !important;
        }

        body.dark .nav-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .nav-item.active {
            background: rgba(212,175,55,0.1);
            border-left: 4px solid var(--accent);
            color: var(--text);
            box-shadow: 0 2px 6px rgba(212,175,55,0.1);
        }

        body.dark .nav-item.active {
            background: rgba(244, 179, 66, 0.1);
            box-shadow: 0 2px 6px rgba(244, 179, 66, 0.1);
        }

        /* Property Name Display */
        .property-name-display {
            background: linear-gradient(135deg, rgba(212,175,55,0.12), rgba(212,175,55,0.06));
            border: 1.5px solid rgba(212,175,55,0.3);
            border-radius: 10px;
            padding: 12px 16px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
            box-shadow: 0 4px 12px rgba(212,175,55,0.08);
            transition: all 0.3s ease;
        }

        body.dark .property-name-display {
            background: linear-gradient(135deg, rgba(244, 179, 66, 0.12), rgba(244, 179, 66, 0.06));
            border: 1.5px solid rgba(244, 179, 66, 0.3);
            box-shadow: 0 4px 12px rgba(244, 179, 66, 0.08);
        }

        .property-name-display:hover {
            box-shadow: 0 6px 16px rgba(212,175,55,0.12);
            border-color: rgba(212,175,55,0.4);
            transform: translateY(-2px);
        }

        body.dark .property-name-display:hover {
            box-shadow: 0 6px 16px rgba(244, 179, 66, 0.12);
            border-color: rgba(244, 179, 66, 0.4);
        }

        .property-name-text {
            font-size: 18px;
            font-weight: 700;
            color: var(--text);
            flex-grow: 1;
            letter-spacing: -0.3px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }

        /* Card Surface */
        .card-surface {
            background: var(--surface);
            border-radius: .75rem;
            box-shadow: 0 18px 40px rgba(16,24,40,0.06);
            padding: 1.25rem;
            border: 1px solid var(--muted);
            transition: all 0.3s ease;
        }

        body.dark .card-surface {
            box-shadow: 0 18px 40px rgba(0,0,0,0.2);
        }

        /* RED VERSION: TABLE HEADER */
        .table-header {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        @media (min-width: 640px) {
            .table-header {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
        }

        .table-header h2 {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--accent);
        }

        /* TABLE Styles */
        .units-wrapper {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            max-width: 100%;
            border-radius: .75rem;
            background: var(--surface);
            border: 1px solid var(--muted);
        }

        .units-table {
            width: 100%;
            min-width: 760px;
            border-collapse: separate;
            border-spacing: 0;
            border-radius: .5rem;
            overflow: hidden;
        }

        .units-table thead th {
            background: var(--table-header-bg);
            color: var(--text);
            font-weight: 700;
            padding: .75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--table-border);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .units-table tbody td {
            background: var(--surface);
            padding: .75rem 1rem;
            border-bottom: 1px solid var(--muted);
            color: var(--text);
            white-space: nowrap;
        }

        .units-table tbody tr:hover td {
            background: var(--table-row-hover);
        }

        .units-table tbody tr:nth-child(even) td {
            background: var(--table-row-even);
        }

        /* Indicator */
        .indicator {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 1.9rem;
            height: 1.9rem;
            border-radius: .5rem;
            font-weight: 700;
        }

        .indicator.bg-red-100, .indicator.bg-red {
            background: rgba(255,69,58,0.08);
            color: #C53030;
        }

        body.dark .indicator.bg-red-100, body.dark .indicator.bg-red {
            background: rgba(239,68,68,0.15);
            color: #fca5a5;
        }

        .indicator.bg-green-100, .indicator.bg-green {
            background: rgba(16,185,129,0.08);
            color: #065f46;
        }

        body.dark .indicator.bg-green-100, body.dark .indicator.bg-green {
            background: rgba(34,197,94,0.15);
            color: #86efac;
        }

        /* Payment Column Highlighting */
        .units-table th:nth-child(6),
        .units-table td:nth-child(6) {
            background: rgba(212,175,55,0.15) !important;
            position: relative;
        }

        body.dark .units-table th:nth-child(6),
        body.dark .units-table td:nth-child(6) {
            background: rgba(244,179,66,0.2) !important;
        }

        .units-table th:nth-child(6)::after,
        .units-table td:nth-child(6)::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            width: 4px;
            background: var(--accent);
            opacity: 0.6;
        }

        /* Status Badges */
        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-active {
            background-color: rgba(16,185,129,0.1);
            color: #065f46;
        }

        body.dark .status-active {
            background-color: rgba(34,197,94,0.15);
            color: #86efac;
        }

        .status-vacant {
            background-color: rgba(239,68,68,0.1);
            color: #991b1b;
        }

        body.dark .status-vacant {
            background-color: rgba(239,68,68,0.15);
            color: #fca5a5;
        }

        /* RED VERSION: EMPTY STATE */
        .empty-state {
            padding: 3rem 1rem;
            text-align: center;
            background: var(--surface);
            border-radius: .75rem;
            border: 2px dashed var(--muted);
        }

        .empty-state-icon {
            font-size: 3rem;
            color: var(--accent);
            margin-bottom: 1rem;
            opacity: 0.7;
        }

        .empty-state-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 0.5rem;
        }

        .empty-state-description {
            color: var(--muted-text);
            max-width: 400px;
            margin: 0 auto 1.5rem;
            line-height: 1.6;
        }

        /* RED VERSION: TABLE SUMMARY */
        .table-summary {
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid var(--muted);
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            color: var(--muted-text);
            font-size: 0.875rem;
        }

        @media (min-width: 640px) {
            .table-summary {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
        }

        .summary-stats {
            display: flex;
            gap: 1rem;
        }

        /* RED VERSION: MESSAGES */
        .message {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            font-size: 0.875rem;
        }

        .message-success {
            background: var(--success-bg);
            color: var(--success-text);
            border: 1px solid rgba(34, 197, 94, 0.2);
        }

        .message-error {
            background: var(--error-bg);
            color: var(--error-text);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        /* Loading Styles */
        .loading-spinner {
            display: inline-block;
            width: 1.5rem;
            height: 1.5rem;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .dashboard-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
                padding: 1rem;
            }

            .quick-stats-bar {
                gap: 0.75rem;
            }

            .quick-stat {
                padding: 1rem;
            }

            .units-table {
                min-width: 600px;
            }
        }
    </style>
</head>

<body class="antialiased" th:classappend="${user_chosen_theme == 'dark'} ? 'dark' : ''">
<!-- Loading Overlay -->
<div id="loadingOverlay" class="loading-overlay">
    <div class="loading-overlay-content">
        <div class="overlay-spinner"></div>
        <p class="text-lg font-semibold text-[var(--text)]">Loading Property...</p>
        <p class="text-sm text-[var(--muted-text)] mt-2">Please wait while we fetch your property data</p>
    </div>
</div>

<script th:inline="javascript">
    const serverTheme = /*[[${user_chosen_theme}]]*/ 'light';
</script>

<!-- YOUR ADD UNIT PAGE HEADER -->
<header class="bg-surface shadow-lg sticky top-0 z-30 transition-colors duration-300">
    <div class="max-w-6xl px-6 py-3 flex items-center justify-between mx-auto">
        <div class="flex items-center gap-3">
            <a class="flex items-center">
                <img src="/umuzi/img/mypromann.png" alt="ProMan logo"
                     class="h-28 md:h-32 lg:h-36 w-auto object-contain">
            </a>
            <div>
                <a class="text-lg font-extrabold text-accent">ProMan</a>
                <div class="text-xs text-muted -mt-1">Property management simplified</div>
            </div>
        </div>

        <!-- Desktop Nav -->
        <nav id="nav-links" class="hidden lg:flex items-center gap-3 text-sm font-medium">
            <a href="http://localhost:7070/"
               class="login-btn border-2 px-4 py-1.5 rounded-lg font-semibold shadow-sm transition-all duration-200">
                Home
            </a>
            <a href="http://localhost:7070/dashboard"
               class="login-btn border-2 px-4 py-1.5 rounded-lg font-semibold shadow-sm transition-all duration-200">
                Dashboard
            </a>
            <a href="http://localhost:7070/log_out"
               class="signup-btn px-5 py-1.5 rounded-lg font-semibold shadow-lg transition-all duration-200 transform hover:-translate-y-0.5">
                Log out
            </a>
        </nav>

        <!-- Mobile Menu Button -->
        <button id="mobile-menu-button" aria-label="Open navigation menu" aria-expanded="false">
            <div class="mobile-menu-icon">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </button>
    </div>

    <!-- Mobile menu (hidden by default) -->
    <div id="mobile-menu" class="lg:hidden hidden px-6 pb-3 space-y-2">
        <a href="http://localhost:7070/"
           class="block w-full text-center login-btn border-2 px-4 py-1.5 rounded-lg font-semibold shadow-sm transition-all duration-200">
            HOME
        </a>
        <a href="http://localhost:7070/dashboard"
           class="block w-full text-center login-btn border-2 px-4 py-1.5 rounded-lg font-semibold shadow-sm transition-all duration-200">
            DASHBOARD
        </a>
        <a href="http://localhost:7070/log_out"
           class="block w-full text-center signup-btn px-5 py-1.5 rounded-lg font-semibold shadow-lg transition-all duration-200 transform hover:-translate-y-0.5">
            LOG OUT
        </a>
    </div>
</header>

<div id="sidebar-backdrop"></div>
<div class="main-wrap">
    <!-- Sidebar - NOW PROPERLY BELOW HEADER -->
    <aside id="sidebar" class="sidebar" role="navigation" aria-label="Main sidebar">
        <div class="sidebar-content">
            <div class="sidebar-header">
                <div class="property-name-display">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                    </svg>
                    <span class="property-name-text" th:text="${name}">Property Name</span>
                </div>
            </div>
            <nav class="mb-4 space-y-2">
                <a href="http://localhost:7070/add_property_unit" class="nav-item active">ADD NEW PROPERTY</a>
                <a href="http://localhost:7070/add_tenant" class="nav-item active">ADD NEW TENANT</a>
            </nav>
            <div class="sidebar-stats">
                <div class="card rounded-lg p-3">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm" style="color:var(--muted-text)">Total Properties</p>
                            <p class="text-lg font-bold" style="color:var(--text)" th:text="${total_properties}">8</p>
                        </div>
                        <div class="feature-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 12l2-2m0 0l7-7 7 7M5 10v10"/></svg>
                        </div>
                    </div>
                </div>

                <div class="card rounded-lg p-3" style="border-left-color: rgba(34,197,94,0.18);">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm" style="color:var(--muted-text)">Occupied Units</p>
                            <p class="text-lg font-bold" style="color:var(--text)" th:text="${occupied_units}">0</p>
                        </div>
                        <div class="feature-icon" style="background: rgba(255,255,255,0.06); color:var(--text)">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4"/></svg>
                        </div>
                    </div>
                    <p class="text-sm"
                       style="color:var(--muted-text); margin-top:6px"
                       th:text="${occupancyRate + '% occupancy rate'}">
                        0% occupancy rate
                    </p>
                </div>

                <div class="card rounded-lg p-3" style="border-left-color: rgba(59,130,246,0.18);">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm" style="color:var(--muted-text)">Vacant Units</p>
                            <p class="text-lg font-bold" style="color:var(--text)"  th:text="${vacant}">2</p>
                        </div>
                        <div class="feature-icon" style="background: rgba(255,255,255,0.06); color:var(--text)">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 12H4"/></svg>
                        </div>
                    </div>
                    <p class="text-sm" style="color:var(--muted-text); margin-top:6px">Available for rent</p>
                </div>

                <div class="card rounded-lg p-3" style="border-left-color: rgba(139,92,60,0.18);">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm" style="color:var(--muted-text)">Monthly Revenue</p>
                            <p class="text-lg font-bold" style="color:var(--text)" th:text="'R' + ${expected_profit}">R0</p>
                        </div>
                        <div class="feature-icon" style="background: rgba(255,255,255,0.06); color:var(--text)">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2"/></svg>
                        </div>
                    </div>
                    <p class="text-sm" style="color:var(--muted-text); margin-top:6px">+R2,500 from last month</p>
                </div>
            </div>

            <div class="mt-auto pt-6">
                <a href="http://localhost:7070/logout"
                   class="w-full flex items-center justify-center gap-2 px-4 py-3 rounded-lg bg-gradient-to-r from-yellow-500 to-yellow-600 text-white font-bold shadow-lg hover:from-yellow-600 hover:to-yellow-700 transition-all duration-200 transform hover:scale-[1.02] active:scale-95">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                    </svg>
                    Sign Out
                </a>
            </div>
        </div>
    </aside>

    <main class="content">
        <!-- Rest of your dashboard content remains exactly the same -->
        <div class="dashboard-container">
            <!-- RED VERSION: DASHBOARD HEADER -->
            <div class="dashboard-header">
                <div>
                    <h1>Property Management</h1>
                    <p>Manage your properties and tenant payments</p>
                </div>
                <div class="date-display">
                    <span class="text-lg font-medium" id="currentDate"></span>
                </div>
            </div>

            <!-- RED VERSION: QUICK STATS BAR -->
            <div class="quick-stats-bar">
                <div class="quick-stat">
                    <div class="quick-stat-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 12l2-2m0 0l7-7 7 7M5 10v10"/></svg>
                    </div>
                    <div class="quick-stat-content">
                        <div class="quick-stat-value" th:text="${total_properties}">8</div>
                        <div class="quick-stat-label">Total Properties</div>
                    </div>
                </div>
                <div class="quick-stat">
                    <div class="quick-stat-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4"/></svg>
                    </div>
                    <div class="quick-stat-content">
                        <div class="quick-stat-value" th:text="${occupied_units}">0</div>
                        <div class="quick-stat-label">Occupied Units</div>
                    </div>
                </div>
                <div class="quick-stat">
                    <div class="quick-stat-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 12H4"/></svg>
                    </div>
                    <div class="quick-stat-content">
                        <div class="quick-stat-value" th:text="${vacant}">2</div>
                        <div class="quick-stat-label">Vacant Units</div>
                    </div>
                </div>
                <div class="quick-stat">
                    <div class="quick-stat-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2"/></svg>
                    </div>
                    <div class="quick-stat-content">
                        <div class="quick-stat-value" th:text="'R' + ${expected_profit}">R0</div>
                        <div class="quick-stat-label">Monthly Revenue</div>
                    </div>
                </div>
            </div>

            <!-- RED VERSION: MAIN CONTENT GRID -->
            <div class="main-content-grid" id="mainContent">
                <!-- Property Selection Section -->
                <div class="property-form-container" id="propertyFormContainer">
                    <div class="card-surface h-full">
                        <h2 class="text-xl font-bold mb-4" style="color:var(--accent)">Manage Property</h2>
                        <form id="propertyForm" action="http://localhost:7070/fetch_property_units" method="post">
                            <div class="form-group">
                                <label class="block text-sm font-medium text-[var(--muted-text)] mb-2">Current Property</label>
                                <div class="p-3 bg-[var(--muted)] rounded-lg mb-3">
                                    <p class="font-semibold" th:text="${name}">Loading...</p>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="propertySelect" class="block text-sm font-medium text-[var(--muted-text)] mb-2">Switch Property</label>
                                <select id="propertySelect" name="name" class="w-full rounded-md border-gray-300 shadow-sm focus:ring-0 focus:border-[var(--accent)]">
                                    <option value="">Select property</option>
                                    <option th:each="name : ${names}" th:value="${name}" th:text="${name}">Default Name</option>
                                </select>
                            </div>
                            <div class="mt-4">
                                <button type="submit" id="propertyFormSubmit" class="w-full inline-flex items-center justify-center gap-2 px-4 py-3 bg-[var(--accent)] text-[var(--text)] rounded-lg hover:bg-[var(--accent-dark)] transition font-medium shadow-lg">
                                    <svg id="propertySubmitIcon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                                    </svg>
                                    <span id="propertySubmitText" class="btn-text">Load Property</span>
                                    <div id="propertySubmitSpinner" class="loading-spinner hidden"></div>
                                </button>
                            </div>
                        </form>

                        <div class="mt-6">
                            <div class="border border-gray-300 rounded-lg overflow-hidden bg-gray-100 flex items-center justify-center h-48">
                                <img src="/umuzi/img/mypromann.png" alt="ProMan logo"
                                     class="h-28 md:h-32 lg:h-36 w-auto object-contain">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Table Section -->
                <div class="table-container" id="tableContainer">
                    <div class="card-surface h-full">
                        <div class="table-header">
                            <h2>Unit Management</h2>
                            <button id="viewTableBtn" class="change-property-btn w-full inline-flex items-center justify-center gap-2 px-4 py-2 bg-[var(--accent)] text-[var(--text)] rounded-lg hover:bg-[var(--accent-dark)] transition font-medium">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                                </svg>
                                View Units Table
                            </button>
                        </div>

                        <div class="controls-wrapper">
                            <div class="text-sm" style="color:var(--text)">
                                Click the payment column to mark a tenant as paid.
                            </div>
                        </div>

                        <!-- RED VERSION: MESSAGES -->
                        <div id="paymentErrorDisplay" class="message message-error hidden" role="alert">
                        </div>

                        <div th:if="${unit != null and unit != ''}" class="message message-success">
                            You have already marked Unit <span th:text="${unit}"></span> as paid this month.
                        </div>

                        <div th:if="${success != null and success != ''}" class="message message-success">
                            Unit <span th:text="${success}"></span> marked as paid this month.
                        </div>

                        <!-- UNITS TABLE -->
                        <div class="units-wrapper">
                            <table class="units-table">
                                <thead>
                                <tr>
                                    <th class="px-4 py-3 whitespace-nowrap">Tenant</th>
                                    <th class="px-4 py-3 whitespace-nowrap">Unit</th>
                                    <th class="px-4 py-3 whitespace-nowrap">Status</th>
                                    <th class="px-4 py-3 whitespace-nowrap">Rent Day</th>
                                    <th class="px-4 py-3 whitespace-nowrap">Overdue</th>
                                    <th class="px-4 py-3 whitespace-nowrap">Payment</th>
                                    <th class="px-4 py-3 whitespace-nowrap">Actions</th>
                                </tr>
                                </thead>
                                <tbody id="unitsTbody">
                                <tr th:each="entry : ${units}" class="hover:cursor-pointer">
                                    <td class="px-4 py-3 whitespace-nowrap">
                                        <div class="tenant-info">
                                            <div class="tenant-details">
                                                <div class="tenant-name" th:text="${entry.value[3]}">Tenant </div>
                                                <div class="status-badge"
                                                     th:with="debtAmount=${entry.value[7]} ?: 0"
                                                     th:classappend="${debtAmount &gt; 0} ? 'status-vacant' : 'status-active'"
                                                     th:data-tenant-contact="${entry.value[8]}"
                                                     th:text="${debtAmount &gt; 0} ? 'Debt: R' + ${debtAmount} : 'No Debt'">
                                                    Contact info
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="px-4 py-3 whitespace-nowrap">
                                        <div class="unit-details">
                                            <div class="unit-number" th:text="${entry.value[0]}">Unit </div>
                                            <div class="unit-rent" th:text="'R ' + ${entry.value[1]}">Rent </div>
                                        </div>
                                    </td>
                                    <td class="px-4 py-3 whitespace-nowrap">
                                        <span th:if="${entry.value[2]} == 'yes'" class="status-badge status-active">Occupied</span>
                                        <span th:if="${entry.value[2]} == 'no'" class="status-badge status-vacant">Vacant</span>
                                    </td>
                                    <td class="px-4 py-3 whitespace-nowrap unit-tenant" th:text="${entry.value[4]}">Rent Day</td>
                                    <td class="px-4 py-3 whitespace-nowrap unit-tenant" th:text="${entry.value[5]}">Overdue Days</td>
                                    <td class="px-4 py-3 whitespace-nowrap payment-cell">
                                        <span th:if="${entry.value[2]} == 'yes'"
                                              th:with="isPaid=${entry.value[6]}"
                                              th:classappend="${isPaid} ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'"
                                              class="indicator open-pay cursor-pointer"
                                              th:data-unit="${entry.value[0]}"
                                              th:data-rent="${entry.value[1]}"
                                              th:data-id="${entry.value[3]}"
                                              th:data-property-name="${propertyName}"
                                              th:data-tenant-contact="${entry.value[8]}"
                                              onclick="openPaymentModal([[${entry.value[0]}]], 'R ' + [[${entry.value[1]}]], '[[${entry.value[3]}]]', '[[${propertyName}]]', '[[${entry.value[8]}]]')"
                                              th:text="${isPaid} ? '+' : '−'">−</span>
                                        <span th:if="${entry.value[2]} == 'no'" class="indicator bg-red-100 text-red-800">−</span>
                                    </td>
                                    <td class="px-4 py-3 whitespace-nowrap">
                                        <a th:href="@{/tenant_profile/{id}/{unit}/{propertyRent}/{contact}(id=${entry.value[3]},unit=${entry.value[0]},propertyRent=${entry.value[1]},contact=${entry.value[8]})}" class="edit-btn">
                                            Edit
                                        </a>
                                    </td>
                                </tr>

                                <!-- RED VERSION: EMPTY STATE -->
                                <tr th:if="${units == null or units.isEmpty()}">
                                    <td colspan="7">
                                        <div class="empty-state">
                                            <div class="empty-state-icon">
                                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-16 h-16">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                                                </svg>
                                            </div>
                                            <h3 class="empty-state-title">No Units Found</h3>
                                            <p class="empty-state-description">
                                                You don't have any units added yet. Get started by adding your first unit and tenant.
                                            </p>
                                            <a href="http://localhost:7070/add_property_unit" class="inline-flex items-center gap-2 px-4 py-2 bg-[var(--accent)] text-[var(--text)] rounded-lg hover:bg-[var(--accent-dark)] transition font-medium">
                                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                                                </svg>
                                                Add New Property
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- RED VERSION: TABLE SUMMARY -->
                        <div class="table-summary">
                            <div>
                                <span class="font-medium" th:text="${units != null ? units.size() : 0}">0</span> units displayed
                            </div>
                            <div class="summary-stats">
                                <div>
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline text-green-600 mr-1">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                                    </svg>
                                    <span th:text="${occupied_units}">0</span> occupied
                                </div>
                                <div>
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-4 h-4 inline text-red-600 mr-1">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                    </svg>
                                    <span th:text="${vacant}">0</span> vacant
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<!-- Payment Modal (same as before) -->
<div id="paymentModal" class="fixed inset-0 bg-black bg-opacity-40 hidden items-center justify-center z-[1000]">
    <div class="modal-card w-96 text-center z-[1001]">
        <div class="bg-white p-6 rounded-lg shadow-lg">
            <h2 class="text-lg font-semibold mb-3">Update Payment Status</h2>
            <p class="text-gray-700 mb-2">Unit: <span id="modalUnitDisplay" class="font-bold"></span></p>
            <p class="text-gray-700 mb-4 text-sm">Original Rent: <span id="modalOriginalRent" class="font-bold"></span></p>
            <form id="paymentForm" method="post">
                <input type="hidden" name="action_type" id="modalAction">
                <input type="hidden" name="unit" id="modalUnit">
                <input type="hidden" name="id" id="modalId">
                <input type="hidden" name="property_name" id="modalPropertyName">
                <input type="hidden" name="tenant_contact" id="modalTenantContact">
                <input type="hidden" name="paid" value="yes">
                <div class="mb-4 text-left">
                    <label for="modalRentInput" class="block text-sm font-medium text-[var(--muted-text)] mb-2">Rent Paid Amount:</label>
                    <input type="number" id="modalRentInput" name="rent" step="0.01" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--accent)] focus:border-transparent" placeholder="Enter rent amount">
                </div>
                <div class="flex gap-3">
                    <button type="submit" id="modalSubmitBtn" class="flex-1 inline-flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium transition">
                        <span class="btn-text">Confirm Payment</span>
                        <div id="modalSubmitSpinner" class="loading-spinner hidden"></div>
                    </button>
                    <button type="button" onclick="closePaymentModal()" class="flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-medium transition">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    // Basic JavaScript for mobile menu and sidebar
    document.addEventListener('DOMContentLoaded', function() {
        // Mobile menu toggle
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');

        if (mobileMenuButton && mobileMenu) {
            mobileMenuButton.addEventListener('click', function() {
                const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';
                mobileMenuButton.setAttribute('aria-expanded', !isExpanded);
                mobileMenu.classList.toggle('hidden');
            });
        }

        // Format current date
        function formatDate() {
            const date = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const formattedDate = date.toLocaleDateString('en-US', options);
            const dateElement = document.getElementById('currentDate');
            if (dateElement) {
                dateElement.textContent = formattedDate;
            }
        }
        formatDate();

        // Toggle property form visibility
        const viewTableBtn = document.getElementById('viewTableBtn');
        const propertyFormContainer = document.getElementById('propertyFormContainer');

        if (viewTableBtn && propertyFormContainer) {
            viewTableBtn.addEventListener('click', function() {
                propertyFormContainer.classList.toggle('hidden');

                if (propertyFormContainer.classList.contains('hidden')) {
                    viewTableBtn.innerHTML = `
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                        </svg>
                        Show Property Selection
                    `;
                } else {
                    viewTableBtn.innerHTML = `
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                        </svg>
                        View Units Table
                    `;
                }
            });
        }

        // Sidebar mobile toggle
        const mobileSidebarButton = document.getElementById('mobile-menu-button');
        const sidebar = document.getElementById('sidebar');
        const sidebarBackdrop = document.getElementById('sidebar-backdrop');

        if (mobileSidebarButton && sidebar && sidebarBackdrop) {
            mobileSidebarButton.addEventListener('click', function() {
                const isExpanded = this.getAttribute('aria-expanded') === 'true';
                this.setAttribute('aria-expanded', !isExpanded);
                sidebar.classList.toggle('overlay-visible');
                sidebarBackdrop.classList.toggle('visible');
                document.body.style.overflow = isExpanded ? '' : 'hidden';
            });

            sidebarBackdrop.addEventListener('click', function() {
                mobileSidebarButton.setAttribute('aria-expanded', 'false');
                sidebar.classList.remove('overlay-visible');
                sidebarBackdrop.classList.remove('visible');
                document.body.style.overflow = '';
            });
        }

        // Close sidebar on link click (mobile)
        const sidebarLinks = document.querySelectorAll('.sidebar a');
        sidebarLinks.forEach(link => {
            link.addEventListener('click', function() {
                if (window.innerWidth <= 1024) {
                    mobileSidebarButton.setAttribute('aria-expanded', 'false');
                    sidebar.classList.remove('overlay-visible');
                    sidebarBackdrop.classList.remove('visible');
                    document.body.style.overflow = '';
                }
            });
        });
    });

    // Payment Modal Functions
    function openPaymentModal(unit, rent, id, propertyName, contact) {
        const modal = document.getElementById('paymentModal');
        document.getElementById('modalUnitDisplay').textContent = unit;
        document.getElementById('modalOriginalRent').textContent = rent;
        document.getElementById('modalUnit').value = unit;
        document.getElementById('modalId').value = id;
        document.getElementById('modalPropertyName').value = propertyName;
        document.getElementById('modalTenantContact').value = contact;
        modal.classList.remove('hidden');
    }

    function closePaymentModal() {
        document.getElementById('paymentModal').classList.add('hidden');
    }
</script>
</body>
</html>